<div>&nbsp;</div>
<div class='container-fluid'>
    <div class='row'>
        <div class='col-sm-12'>
            <section class='panel panel-default'>
                <div class='panel-heading'>
                    <legend>Create Offer</legend>
                </div>
                <div class='panel-body'>
                    <wizard on-finish='createOffer()'>
                        <wz-step title='Offer Basics' canexit='validateStep1'>
                            <div class='well well-lg'>
                                <form class='form-horizontal' role='form'>
                                    <legend>Offer Basics</legend>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>
                                            Offer Type <i class='fa fa-asterisk'></i>
                                        </label>
                                        <div class='col-sm-6' ng-class='{"has-error": formFailure && !offer.offer_type}'>
                                            <select class='form-control' ng-model='offer.offer_type'>
                                                <option value='' ng-if='!offer.offer_type'>Choose the offer type</option>
                                                <option ng-repeat='(key, val) in offer_types' value='{{key}}'>{{val}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>User Sourced</label>
                                        <div class='col-sm-6'>
                                            <input type='checkbox' bs-switch ng-model='offer.user_sourced' switch-on-text='YES' switch-off-text='NO'>
                                        </div>
                                    </div>
                                    <div class='form-group' ng-if='offer.user_sourced'>
                                        <label class='col-sm-2 control-label'>User ID <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-6' ng-class='{"has-error": formFailure && !offer.offer_user_source}'>
                                            <input type='text' ng-model='offer.offer_user_source' ng-pattern='/^[a-zA-Z0-9]{24}$/' class='form-control'>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class='well well-lg' ng-if='offer.offer_type==="checkin"'>
                                <form class='form-horizontal' role='form'>
                                    <legend>Offer Rules</legend>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>Criteria <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-6' ng-class='{"has-error": formFailure && !offer.rule.event_match}'>
                                            <select class='form-control' ng-model='offer.rule.event_match'>
                                                <option value='' ng-if='!offer.rule.event_match'>Choose a criteria</option>
                                                <option ng-repeat='(key, val) in event_matches' value='{{key}}'>{{val}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class='form-group' ng-if='offer.rule.event_match'>
                                        <label class='col-sm-12'>Reward will be unlocked...</label>
                                        <div class='col-sm-12' ng-if='offer.rule.event_match==="on every"'>
                                            <label class='col-sm-2 control-label'>Every <i class='fa fa-sm fa-asterisk'></i></label>
                                            <div class='col-sm-2' ng-class='{"has-error": formFailure && !offer.rule.event_count}'>
                                                <input type='number' class='form-control text-right' ng-model='offer.rule.event_count' placeholder='Eg. 1, 2, 3...' min='1' steps='1'>
                                            </div>
                                            <label class='col-sm-2 control-label'>Starting <i class='fa fa-sm fa-asterisk'></i></label>
                                            <div class='col-sm-2' ng-class='{"has-error": formFailure && !offer.rule.event_start}'>
                                                <input type='number' class='form-control text-right' ng-model='offer.rule.event_start' placeholder='Eg. 0, 1, 2...' min='0' steps='1'>
                                            </div>
                                            <div class='clearfix'></div>
                                            <div>&nbsp;</div>
                                            <label class='col-sm-2 control-label'>Upto <i class='fa fa-sm fa-asterisk'></i></label>
                                            <div class='col-sm-2' ng-class='{"has-error": formFailure && !offer.rule.event_end}'>
                                                <input type='number' class='form-control text-right' ng-model='offer.rule.event_end' placeholder='Eg. 2, 3, 4...' min='{{(offer.rule.event_start + 1) || 1}}' steps='1'>
                                            </div>
                                        </div>
                                        <div class='col-sm-12' ng-if='offer.rule.event_match==="after"'>
                                            <label class='col-sm-2 control-label'>Starting <i class='fa fa-sm fa-asterisk'></i></label>
                                            <div class='col-sm-2' ng-class='{"has-error": formFailure && !offer.rule.event_start}'>
                                                <input type='number' class='form-control text-right' ng-model='offer.rule.event_start' placeholder='Eg. 1, 2, 3...' min='0' steps='1'>
                                            </div>
                                            <label class='col-sm-2 control-label'>Upto <i class='fa fa-sm fa-asterisk'></i></label>
                                            <div class='col-sm-2' ng-class='{"has-error": formFailure && !offer.rule.event_end}'>
                                                <input type='number' class='form-control text-right' ng-model='offer.rule.event_end' placeholder='Eg. 1, 2, 3...' min='{{offer.rule.event_start + 1}}' steps='1'>
                                            </div>
                                        </div>
                                        <div class='col-sm-12' ng-if='offer.rule.event_match=="on only"'>
                                            <label class='col-sm-2 control-label'>On the <i class='fa fa-sm fa-asterisk'></i></label>
                                            <div class='col-sm-2' ng-class='{"has-error": formFailure && !offer.rule.event_count}'>
                                                <input type='number' class='form-control text-right' ng-model='offer.rule.event_count' placeholder='Eg. 1, 2, 3...' min='1'>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class='well well-lg'>
                                <legend>Reward Details</legend>
                                <form class='form-horizontal' role='form'>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>Applicable for <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-6'>
                                            <div class='btn-group'>
                                                <label class='btn' ng-class='{"btn-default": !offer.actions.reward.applicability.dine_in, "btn-primary": offer.actions.reward.applicability.dine_in}' ng-model='offer.actions.reward.applicability.dine_in' btn-checkbox>Dine-In</label>
                                                <label class='btn' ng-class='{"btn-default": !offer.actions.reward.applicability.delivery, "btn-primary": offer.actions.reward.applicability.delivery}' ng-model='offer.actions.reward.applicability.delivery' btn-checkbox>Delivery</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>Reward Type <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-6' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.reward_type}'>
                                            <select class='form-control' ng-model='offer.actions.reward.reward_meta.reward_type' ng-disabled='!offer.actions.reward.applicability.dine_in && !offer.actions.reward.applicability.delivery'>
                                                <option value='' ng-if='!offer.actions.reward.reward_meta.reward_type && !offer.actions.reward.applicability.dine_in && !offer.actions.reward.applicability.delivery'>Define Applicability First</option>
                                                <option value='' ng-if='!offer.actions.reward.reward_meta.reward_type  && (offer.actions.reward.applicability.dine_in || offer.actions.reward.applicability.delivery)'>Choose a reward type</option>
                                                <option ng-show='!offer.actions.reward.applicability.delivery' ng-repeat='(key, val) in generic_reward_types' value='{{key}}'>{{val}}</option>
                                                <option ng-show='offer.actions.reward.applicability.delivery' ng-repeat='(key, val) in delivery_reward_types' value='{{key}}'>{{val}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class='form-group' ng-if='offer.actions.reward.reward_meta.reward_type'>
                                        <label class='col-sm-2 control-label'>Reward Info</label>
                                        <div class='col-sm-10'>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Header <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5' ng-class='{"has-error": formFailure && !offer.actions.reward.header}'>
                                                    <input type='text' ng-model='offer.actions.reward.header' class='form-control'>
                                                </div>
                                            </div>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Line 1 <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5' ng-class='{"has-error": formFailure && !offer.actions.reward.line1}'>
                                                    <input type='text' ng-model='offer.actions.reward.line1' class='form-control'>
                                                </div>
                                            </div>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Line 2</label>
                                                <div class='col-sm-5'>
                                                    <input type='text' ng-model='offer.actions.reward.line2' class='form-control'>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='form-group' ng-if='offer.actions.reward.reward_meta.reward_type'>
                                        <label class='col-sm-2 control-label'>Reward Specifics <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-10' ng-if='offer.actions.reward.reward_meta.reward_type==="buyxgety"'>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Free Item <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <button type='button' class='btn btn-block' ng-class='{"btn-primary": !formFailure, "btn-danger": formFailure}' ng-click='chooseItem("buyxgety_1", true)' ng-if='!offer.offer_items.menus.length'>Choose Item</button>
                                                    <button type='button' class='btn btn-block btn-success' ng-click='chooseItem("buyxgety_1", true)' ng-if='offer.offer_items.menus.length'>Update Item</button>
                                                </div>
                                            </div>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Paid Item <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <h4 ng-if='offer.actions.reward.reward_meta.paid_item && offer.actions.reward.reward_meta.paid_item.paid_item_name'>{{offer.actions.reward.reward_meta.paid_item.paid_item_name}}</h4>
                                                    <button type='button' class='btn btn-block' ng-class='{"btn-primary": !formFailure, "btn-danger": formFailure}' ng-click='chooseItem("buyxgety_2", true)' ng-if='!offer.actions.reward.reward_meta.paid_item'>Choose Item</button>
                                                    <button type='button' class='btn btn-block btn-success' ng-click='chooseItem("buyxgety_2", true)' ng-if='offer.actions.reward.reward_meta.paid_item'>Update Item</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-sm-10' ng-if='offer.actions.reward.reward_meta.reward_type==="free" && offer.actions.reward.applicability.delivery'>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Free Item <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <h4 ng-if='offer.offer_items.menus.length && offer.actions.reward.reward_meta.free_item_name'>{{offer.actions.reward.reward_meta.free_item_name}}</h4>
                                                    <button type='button' class='btn btn-block' ng-class='{"btn-primary": !formFailure, "btn-danger": formFailure}' ng-click='chooseItem("free", true)' ng-if='!offer.offer_items.menus.length'>Choose Item</button>
                                                    <button type='button' class='btn btn-block btn-success' ng-click='chooseItem("free", true)' ng-if='offer.offer_items.menus.length'>Update Item</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-sm-10' ng-if='offer.actions.reward.reward_meta.reward_type==="free" && !offer.actions.reward.applicability.delivery'>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Free Item <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <input type='text' ng-model='offer.actions.reward.reward_meta.title' class='form-control'>
                                                </div>
                                            </div>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Conditions <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <input type='text' ng-model='offer.actions.reward.reward_meta._with' class='form-control' placeholder='Eg. min order of Rs.X or with purchase of Y'>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-md-10' ng-if='offer.actions.reward.reward_meta.reward_type=="happyhours"' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.extension}'>
                                            <label class='col-md-2 control-label'>Extention By <i class='fa fa-sm fa-asterisk'></i></label>
                                            <div class='col-md-5'>
                                                <div class='input-group'>
                                                    <input type='number' ng-model='offer.actions.reward.reward_meta.extension' class='form-control'>
                                                    <div class='input-group-addon'>hrs.</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-md-10' ng-if='offer.actions.reward.reward_meta.reward_type=="reduced"'>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.what}'>
                                                <label class='col-sm-2 control-label'>Item <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <input type='text' ng-model='offer.actions.reward.reward_meta.what' class='form-control'>
                                                </div>
                                            </div>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.worth}'>
                                                <label class='col-sm-2 control-label'>Worth <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <div class='input-group'>
                                                        <div class='input-group-addon'>
                                                            <i class='fa fa-inr'></i>
                                                        </div>
                                                        <input type='number' ng-model='offer.actions.reward.reward_meta.worth' class='form-control'>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.for_what}'>
                                                <label class='col-sm-2 control-label'>For <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <div class='input-group'>
                                                        <div class='input-group-addon'><i class='fa fa-inr'></i></div>
                                                        <input type='number' ng-model='offer.actions.reward.reward_meta.for_what' class='form-control'>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-md-10' ng-if='offer.actions.reward.reward_meta.reward_type=="custom"'>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.title}'>
                                                <label class='col-sm-2 control-label'>Custom Text <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <textarea class='form-control' ng-model='offer.actions.reward.reward_meta.title' rows='5'></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-md-10' ng-if='offer.actions.reward.reward_meta.reward_type=="unlimited"'>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.item}'>
                                                <label class='col-sm-2 control-label'>Item <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <input type='text' ng-model='offer.actions.reward.reward_meta.item' class='form-control'>
                                                </div>
                                            </div>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.conditions}'>
                                                <label class='col-sm-2 control-label'>For <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <div class='input-group'>
                                                        <div class='input-group-addon'><i class='fa fa-inr'></i></div>
                                                        <input type='text' ng-model='offer.actions.reward.reward_meta.conditions' class='form-control'>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-md-10' ng-if='offer.actions.reward.reward_meta.reward_type=="onlyhappyhours"'>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.title}'>
                                                <label class='col-sm-2 control-label'>Deal <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <input type='text' class='form-control' ng-model='offer.actions.reward.reward_meta.title'>
                                                </div>
                                            </div>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.conditions}'>
                                                <label class='col-md-2 control-label'>Conditions <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-md-5'>
                                                    <input type='text' class='form-control' ng-model='offer.actions.reward.reward_meta.conditions'>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-sm-10' ng-if='offer.actions.reward.reward_meta.reward_type==="flatoff"'>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Amount Off <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.off}'>
                                                    <div class='input-group'>
                                                        <span class='input-group-addon'><i class='fa fa-inr'></i></span>
                                                        <input type='number' ng-model='offer.actions.reward.reward_meta.off' class='form-control'>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Min Spend <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.spend}'>
                                                    <div class='input-group'>
                                                        <span class='input-group-addon'><i class='fa fa-inr'></i></span>
                                                        <input type='number' ng-model='offer.actions.reward.reward_meta.spend' class='form-control'>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-sm-10' ng-if='offer.actions.reward.reward_meta.reward_type==="discount"'>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Percent Off <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.percent}'>
                                                    <div class='input-group'>
                                                        <input type='text' min='1' steps='1' class='form-control text-right' ng-model='offer.actions.reward.reward_meta.percent'>
                                                        <span class='input-group-addon'> % </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>Max Discount <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.max}'>
                                                    <div class='input-group'>
                                                        <span class='input-group-addon'><i class='fa fa-inr'></i></span>
                                                        <input type='number' ng-model='offer.actions.reward.reward_meta.max' class='form-control'>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-sm-10' ng-if='offer.actions.reward.reward_meta.reward_type==="buyonegetone"'>
                                            <div class='form-group'>
                                                <label class='col-sm-2 control-label'>BOGO Item <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.bogo}'>
                                                    <input type='text' ng-model='offer.actions.reward.reward_meta.bogo' class='form-control' placeholder='provide item name here'>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-sm-10' ng-if='offer.actions.reward.reward_meta.reward_type==="combo"'>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.items}'>
                                                <label class='col-sm-2 control-label'>Items <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <input type='text' class='form-control' ng-model='offer.actions.reward.reward_meta.items'>
                                                </div>
                                            </div>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta._for}'>
                                                <label class='col-sm-2 control-label'>For <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <input type='number' class='form-control' ng-model='offer.actions.reward.reward_meta._for'>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='col-md-10' ng-if='offer.actions.reward.reward_meta.reward_type=="buffet"'>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.title}'>
                                                <label class='col-sm-2 control-label'>Deal <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <textarea rows='3' ng-model='offer.actions.reward.reward_meta.title' class='form-control' ng-change='updateBuffetOffer(offer)'></textarea>
                                                </div>
                                            </div>
                                            <div class='form-group' ng-class='{"has-error": formFailure && !offer.actions.reward.reward_meta.cost}'>
                                                <label class='col-sm-2 control-label'>Cost <i class='fa fa-sm fa-asterisk'></i></label>
                                                <div class='col-sm-5'>
                                                    <div class='input-group'>
                                                        <div class='input-group-addon'><i class='fa fa-inr'></i></div>
                                                        <input type='number' ng-model='offer.actions.reward.reward_meta.cost' class='form-control' ng-change='updateBuffetOffer(offer)'>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='form-group' ng-if='(offer.actions.reward.reward_meta.reward_type==="flatoff" || offer.actions.reward.reward_meta.reward_type==="discount") && offer.actions.reward.applicability.delivery'>
                                        <label class='col-sm-2 control-label'>Apply to all items</label>
                                        <div class='col-sm-6'>
                                            <input bs-switch ng-model='offer.offer_items.all' type='checkbox' switch-off-text='NO' switch-on-text='YES'>
                                        </div>
                                    </div>
                                    <div class='form-group' ng-if='(offer.actions.reward.reward_meta.reward_type==="flatoff" || offer.actions.reward.reward_meta.reward_type==="discount") && !offer.offer_items.all'>
                                        <label class='col-sm-2 control-label'>Reward Items <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-6'>
                                            <button class='btn btn-block' ng-class='{"btn-primary": !formFailure, "btn-danger": formFailure}' ng-if='!offer.offer_items.menus.length' ng-click='chooseItem("", false)'>Choose Items</button>
                                            <button class='btn btn-block btn-success' ng-if='offer.offer_items.menus.length' ng-click='chooseItem("", false)'>Update Items</button>
                                        </div>
                                    </div>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>Offer Description</label>
                                        <div class='col-sm-6'>
                                            <textarea class='form-control' ng-model='offer.actions.reward.description' rows='3'></textarea>
                                            <div class='help-block'>Add detailed offer description here if header, line 1 and line 2 do not capture all offer details.</div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class='clearfix'></div>
                            <button type="button" class="btn btn-w-sm btn-gap-v btn-direction btn-right btn-primary" wz-next>Next</button>
                        </wz-step>
                        <wz-step title='T&C' canexit='validateStep2'>
                            <div class='well well-lg'>
                                <form class='form-horizontal' role='form'>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>Minimum Bill <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-6' ng-class='{"has-error": formFailure && !offer.minimum_bill_value}'>
                                            <div class='input-group'>
                                                <span class='input-group-addon'><i class='fa fa-inr'></i></span>
                                                <input type='number' class='form-control' ng-model='offer.minimum_bill_value'>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='form-group' ng-if='offer.offer_type==="checkin"'>
                                        <label class='col-sm-2 control-label'>Lapses In <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-2' ng-class='{"has-error": formFailure && !offer.offer_lapse_days}'>
                                            <div class='input-group'>
                                                <input type='number' class='form-control' ng-model='offer.offer_lapse_days' min='1' steps='1'>
                                                <span class='input-group-addon'>days</span>
                                            </div>
                                        </div>
                                        <label class='col-sm-2 control-label'>Expires in <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-2' ng-class='{"has-error": formFailure && !offer.offer_valid_days}'>
                                            <div class='input-group'>
                                                <input type='number' class='form-control' ng-model='offer.offer_valid_days' min='{{offer.offer_lapse_days + 14}}'>
                                                <span class='input-group-addon'>days</span>
                                            </div>
                                        </div>
                                        <div class='clearfix'></div>
                                        <div class='col-sm-offset-2 col-sm-6 help-block'>Expiration duration must be atleast 14 days more than lapse duration.</div>
                                    </div>
                                    <div class='form-group' ng-if='offer.offer_type==="offer"'>
                                        <label class='col-sm-2 control-label'>Offer Cost <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-6' ng-class='{"has-error": formFailure && !offer.offer_cost}'>
                                            <select class='form-control' ng-model='offer.offer_cost'>
                                                <option ng-repeat='i in getRange(18) track by $index' value='{{100+ (25*$index)}}'>{{100 + (25*$index)}}</option>
                                            </select>
                                            <div class='help-block'>Cost above is defined in Twyst Bucks</div>
                                        </div>
                                    </div>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>Offer Terms</label>
                                        <div class='col-sm-6'>
                                            <textarea rows='6' class='form-control' ng-model='offer.actions.reward.terms' placeholder='any adition terms not covered below'></textarea>
                                            <div class='help-block'>
                                                <p>
                                                    <b>Common terms for all offers</b>
                                                </p>
                                                <ul>
                                                    <li>
                                                        Offers (2 or more) cannot be clubbed
                                                    </li>
                                                    <li>
                                                        Offers are not valid on specially priced combinations e.g. any other buffet/brunch deal/corporate dining rate/happy hours etc.
                                                    </li>
                                                    <li>
                                                        Only 1 voucher / offer can be used per bill generated
                                                    </li>
                                                    <li>
                                                        In certain cases, specific items may be part of the offer. The avialability of the specific items is not guaranteed and must be checked with the outlet before using the offer.
                                                    </li>
                                                    <li>
                                                        The offer are provided at the sole discretion of the merchant, and the merchant reserves the right to alter ot withdraw the offer at any time.
                                                    </li>
                                                    <li>
                                                        Offers/vouchers consisting of alcohol/alcohol-based products will be available only to individuals above legal drinking age. The establishment reserves the right to verify the customer's age before providing such reward.
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class='well well-lg'>
                                <form class='form-horizontal' role='form'>
                                    <legend>Applicability</legend>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>Outlets <i class='fa fa-sm fa-asterisk'></i></label>
                                        <div class='col-sm-6'>
                                            <ul class='list-group' ng-if='offer.offer_outlets.length'>
                                                <li class='list-group-item' ng-repeat='outlet in offer.offer_outlets track by $index'>
                                                    {{outlets[outlet].basics.name}}, {{outlets[outlet].contact.location.locality_1[0]}}, {{outlets[outlet].contact.location.locality_2[0]}}
                                                    <button class='btn btn-sm btn-danger pull-right' ng-click='removeOutlet($index)'><i class='fa fa-trash-o'></i></button>
                                                </li>
                                            </ul>
                                            <div class='alert' ng-if='!offer.offer_outlets.length' ng-class='{"alert-warning": !formFailure, "alert-danger": formFailure && !(offer.offer_outlets && offer.offer_outlets.length)}'>
                                                <span ng-if='!formFailure'>Start adding outlets below.</span>
                                                <span ng-if='formFailure'>Choose atleast one outlet</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>
                                            <span ng-if='!offer.offer_outlets.length'>Pick the first Outlet</span>
                                            <span ng-if='offer.offer_outlets.length'>Pick another Outlet</span>
                                        </label>
                                        <div class='col-sm-6 table-responsive'>
                                            <ul class='list-group'>
                                                <li class='list-group-item' ng-repeat='outlet in outlets track by $index' ng-show='!offer.offer_outlets || offer.offer_outlets.indexOf(outlet._id)===-1'>
                                                    {{outlet.basics.name}}, {{outlet.contact.location.locality_1[0]}}, {{outlet.contact.location.locality_2[0]}}
                                                    <button class='btn btn-sm btn-success pull-right' ng-click='addOutlet(outlet._id)'><i class='fa fa-plus'></i></button>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class='form-group'>
                                        <label class='col-sm-2 control-label'>Offer Timings</label>
                                        <div class='col-sm-8'>
                                            <select ng-model='tempOutlet._id' class='form-control' ng-change='cloneTimings(tempOutlet)'>
                                                <option value=''>Choose an Outlet To Clone From</option>
                                                <option ng-repeat='outletId in offer.offer_outlets' value='{{outletId}}'>
                                                    {{outlets[outletId].basics.name}}, {{outlets[outletId].contact.location.locality_1[0]}}, {{outlets[outletId].contact.location.locality_2[0]}}
                                                </option>
                                            </select>
                                            <div class='clearfix'></div>
                                            <p>&nbsp;</p>
                                            <table class='table table-bordered table-stripped table-hover table-responsive'>
                                                <thead>
                                                    <th>Day</th>
                                                    <th>Open/Closed</th>
                                                    <th ng-repeat='i in getMaxRange() track by $index'>Timing {{$index + 1}}</th>
                                                    <th>Add Timing</th>
                                                    <th>Clone To All</th>
                                                </thead>
                                                <tbody>
                                                    <tr ng-repeat='day in days'>
                                                        <th>{{day | uppercase}}</th>
                                                        <td>
                                                            <input type='checkbox' bs-switch ng-model='offer.actions.reward.reward_hours[day].closed' switch-off-text='OPEN' switch-on-text='CLOSE' switch-off-color='success' switch-on-color='danger'>
                                                        </td>
                                                        <td ng-repeat='i in getMaxRange() track by $index' ng-class='{"has-error": formFailure && errorDay===day}'>
                                                            <div class='col-md-12' ng-if='offer.actions.reward.reward_hours[day].timings.length>1 && offer.actions.reward.reward_hours[day].timings[$index]' ng-click='removeTiming(day, $index)' ng-init='initalizeTiming(day, $index, offer.actions.reward.reward_hours)'>
                                                                <button class='btn btn-sm btn-danger pull-right'><i class='fa fa-trash-o'></i></button>
                                                            </div>
                                                            <div class='col-md-12' ng-if='offer.actions.reward.reward_hours[day].timings[$index]'>
                                                                <input type='time' ng-model='offer.actions.reward.reward_hours[day].timings[$index].open.time' placeholder="HH:MM A/P" class='form-control' ng-change='updateTime(day, $index, offer.actions.reward.reward_hours)'>
                                                            </div>
                                                            <div class='col-md-12 text-center' ng-if='offer.actions.reward.reward_hours[day].timings[$index]'> to </div>
                                                            <div class='col-md-12' ng-if='offer.actions.reward.reward_hours[day].timings[$index]'>
                                                                <input type='time' ng-model='offer.actions.reward.reward_hours[day].timings[$index].close.time' placeholder="HH:MM A/P" class='form-control' ng-change='updateTime(day, $index, offer.actions.reward.reward_hours)'>
                                                            </div>
                                                        </td>
                                                        <td>
                                                            <button type='button' class='btn btn-sm btn-default' ng-click='addNewTiming(day, offer.actions.reward.reward_hours)' ng-if='!offer.actions.reward.reward_hours[day].closed'><i class='fa fa-plus'></i> Timing</button>
                                                        </td>
                                                        <td>
                                                            <button type='button' class='btn btn-sm btn-info' ng-click='cloneToAllDays(day, offer.actions.reward.reward_hours)'><i class='fa fa-copy'> Clone</i></button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class='form-group'>
                                        <div class='col-sm-offset-2 col-sm-8'>
                                            <div class='form-group'>
                                                <div class='col-sm-6'>
                                                    <label class='control-label'>Start Date <i class='fa fa-sm fa-asterisk'></i></label>
                                                    <datepicker ng-model='offer.offer_start_date' show-weeks='true' class='well well-sm'></datepicker>
                                                </div>
                                                <div class='col-sm-6'>
                                                    <label class='control-label'>End Date <i class='fa fa-sm fa-asterisk'></i></label>
                                                    <datepicker ng-model='offer.offer_end_date' min-date='offer.offer_start_date' show-weeks='true' class='well well-sm'></datepicker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class='clearfix'></div>
                            <button type="button" class="btn btn-w-sm btn-gap-v btn-direction btn-left btn-danger" wz-previous>Prev</button>
                            <button type="button" class="btn btn-w-sm btn-gap-v btn-direction btn-right btn-primary" wz-next>Next</button>
                        </wz-step>
                        <wz-step title='Review'>
                            <div class='panel panel-default'>
                                <div class='panel-heading'>Offer Basics</div>
                                <div class='panel-body'>
                                    <div class='col-sm-6'>
                                        <h2>{{offer.actions.reward.header}}</h2>
                                        <h4>{{offer.actions.reward.line1}}</h4>
                                        <h4 ng-if='offer.actions.reward.line2'>{{offer.actions.reward.line2}}</h4>
                                        <div>&nbsp;</div>
                                        <div class="help-block" ng-if='offer.actions.reward.description'>Offer Description</div>
                                        <textarea class='form-control' rows="3" ng-if='offer.actions.reward.description' ng-model='offer.actions.reward.description' disabled></textarea>
                                        <div>&nbsp;</div>
                                        <div class="help-block" ng-if='offer.actions.reward.terms'>Extra Terms</div>
                                        <textarea class='form-control' rows="3" ng-if='offer.actions.reward.terms' ng-model='offer.actions.reward.terms' disabled></textarea>
                                        <div class='clearfix'></div>
                                        <p>&nbsp;</p>
                                        <div class='pull-left' ng-if='offer.offer_type==="checkin"'>Lapse Duration <span class='label label-primary'>{{offer.offer_lapse_days}} days</span></div>
                                        <div class='pull-right' ng-if='offer.offer_type==="checkin"'>Expire Duration <span class='label label-primary'>{{offer.offer_valid_days}} days</span></div>
                                    </div>
                                    <div class='col-sm-6'>
                                        <h4>Offer Type: <span class='label label-primary'>{{offer_types[offer.offer_type]}}</span></h4>
                                        <div>
                                            <h4>Validity</h4>
                                            <span class='label label-default'>{{offer.offer_start_date | date:longDate}}</span> to <span class='label label-default'>{{offer.offer_end_date | date:longDate}}</span>
                                        </div>
                                        <div>
                                            <h4>Reward Type</h4>
                                            <span class='label label-default'>{{reward_types[offer.actions.reward.reward_meta.reward_type]}}</span>
                                        </div>
                                        <div>
                                            <h4>Reward Info</h4>
                                            <div ng-if='offer.actions.reward.reward_meta.reward_type==="discount"'>
                                                Get
                                                <span class='label label-success'>{{offer.actions.reward.reward_meta.percent + '%'}}</span> for a maximum discount of upto <span class='label label-success'><i class='fa fa-inr'></i> {{offer.actions.reward.reward_meta.max}}</span>
                                            </div>
                                            <div ng-if='offer.actions.reward.reward_meta.reward_type==="flatoff"'>
                                                Get
                                                <span class='label label-success'><i class='fa fa-inr'></i> {{offer.actions.reward.reward_meta.off}}</span> on a minimum spend of <span class='label label-success'><i class='fa fa-inr'></i> {{offer.actions.reward.reward_meta.spend}}</span>
                                            </div>
                                            <div ng-if='offer.actions.reward.reward_meta.reward_type==="free"'>
                                                <span class='label label-success'>{{offer.actions.reward.reward_meta.free_item.free_item_name}}</span> FREE
                                            </div>
                                            <div ng-if='offer.actions.reward.reward_meta.reward_type==="buyxgety"'>
                                                <span class='label label-success'>{{offer.actions.reward.reward_meta.free_item_name}}</span> FREE with <span class='label label-success'> {{offer.actions.reward.reward_meta.paid_item.paid_item_name}}</span>
                                            </div>
                                        </div>
                                        <div ng-if='offer.offer_type==="checkin"'>
                                            <h4>Offer Rules</h4>
                                            <div ng-if='offer.rule.event_match==="on every"'>
                                                Applicable on every <span class='label label-success'>{{offer.rule.event_count + ((offer.rule.event_count==1)? 'st': (offer.rule.event_count==2)? 'nd': (offer.rule.event_count==3)? 'rd': 'th')}}</span> checkin from <span class='label label-success'>{{offer.rule.event_start + ((offer.rule.event_start==1)? 'st': (offer.rule.event_start==2)? 'nd': (offer.rule.event_start==3)? 'rd': 'th')}}</span> to <span class='label label-success'>{{offer.rule.event_end + ((offer.rule.event_end==1)? 'st': (offer.rule.event_end==2)? 'nd': (offer.rule.event_end==3)? 'rd': 'th')}}</span> checkin.
                                            </div>
                                            <div ng-if='offer.rule.event_match==="after"'>
                                                Applicable on every checkin from <span class='label label-success'>{{offer.rule.event_start + ((offer.rule.event_start==1)? 'st': (offer.rule.event_start==2)? 'nd': (offer.rule.event_start==3)? 'rd': 'th')}}</span> uptil <span class='label label-success'>{{offer.rule.event_end + ((offer.rule.event_end==1)? 'st': (offer.rule.event_end==2)? 'nd': (offer.rule.event_end==3)? 'rd': 'th')}}</span> checkin.
                                            </div>
                                            <div ng-if='offer.rule.event_match==="on only"'>
                                                Application on the <span class='label label-success'>{{offer.rule.event_count + ((offer.rule.event_count==1)? 'st': (offer.rule.event_count==2)? 'nd': (offer.rule.event_count==3)? 'rd': 'th')}}</span> checkin.
                                            </div>
                                        </div>
                                        <div>
                                            <h4>Applicable on: </h4>
                                            <span ng-if='offer.actions.reward.applicability.dine_in' class='label label-success'>Dine in</span>
                                            <span ng-if='offer.actions.reward.applicability.delivery' class='label label-success'>Delivery</span>
                                        </div>
                                        <div>
                                            <h4>Minimum Bill <span class='label label-success'><i class='fa fa-inr'></i>{{offer.minimum_bill_value}}</span></h4>
                                        </div>
                                        <div ng-if='offer.offer_type=="offer"'>
                                            <h4>Offer Cost <span class='label label-success'>{{offer.offer_cost}}</span> Twyst Bucks</h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <p>&nbsp;</p>
                            <div class='panel panel-default'>
                                <div class='panel-heading'>Timing & Availability</div>
                                <div class='panel-body'>
                                    <div class='col-sm-6'>
                                        <h3>Timings</h3>
                                        <div class='row' ng-repeat='day in days'>
                                            <h4>{{day | uppercase}}</h4>
                                            <span class='label label-warning' ng-if='offer.actions.reward.reward_hours[day].closed'>Closed</span>
                                            <span class='label label-success' ng-if='!offer.actions.reward.reward_hours[day].closed'>Open</span>
                                            <span ng-repeat='timing in offer.actions.reward.reward_hours[day].timings' style='margin-left:10px;margin-right:10px;'><span class='label label-primary'>{{timing.open.time | date: 'hh:mm a'}}</span> to <span class='label label-primary'>{{timing.close.time | date: 'hh:mm a'}}</span></span>
                                        </div>
                                    </div>
                                    <div class='col-sm-6'>
                                        <h4>Outlets where Available</h4>
                                        <ul class='list-group inverse'>
                                            <li class='list-group-item list-group-item-info' ng-repeat='outlet in offer.offer_outlets track by $index'>
                                                {{outlets[outlet].basics.name}}, {{outlets[outlet].contact.location.locality_1[0]}}, {{outlets[outlet].contact.location.locality_2[0]}}
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class='clearfix'></div>
                            <button type="button" class="btn btn-w-sm btn-gap-v btn-direction btn-left btn-danger" ng-click='backToStart()'>Back To First Step</button>
                            <button type="button" class="btn btn-w-sm btn-gap-v btn-direction btn-right btn-primary" wz-next>Create Offer</button>
                        </wz-step>
                    </wizard>
                </div>
            </section>
        </div>
    </div>
</div>
